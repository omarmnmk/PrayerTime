<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Prayer Times Notifications</title>

<!-- OneSignal SDK -->
<script src="https://cdn.onesignal.com/sdks/OneSignalSDK.js" async=""></script>
<script>
  window.OneSignal = window.OneSignal || [];
  OneSignal.push(function() {
    OneSignal.init({
      appId: "Y598c308f-f74e-4449-8635-b9033d340cbc" // This will be dynamically filled by your deployment, if needed
    });
  });
</script>
</head>

<body>
  <h1>Today's Prayer Times</h1>
  <div id="prayer-times"></div>

  <button onclick="subscribeUser()">Subscribe to Notifications</button>

  <script>
    fetch('https://prayertime.fly.dev/prayer-times')
      .then(response => response.json())
      .then(data => {
        if (data.error) {
          document.getElementById("prayer-times").textContent = "Failed to load prayer times.";
          return;
        }
  
        // Show dates
        document.getElementById("dates").innerHTML = `
          <div><strong>Date:</strong> ${data.date}</div>
          <div><strong>Hijri:</strong> ${data.hijri_date}</div>
        `;
  
        // Ordered list of prayers
        const orderedPrayers = ["Fajr", "Sunrise", "Zuhr", "Asr", "Maghrib", "Isha"];
        const container = document.getElementById("prayer-times");
  
        orderedPrayers.forEach(prayer => {
          const times = data.prayer_times[prayer];
          if (times) {
            const div = document.createElement("div");
            div.className = "prayer";
            div.innerHTML = `<strong>${prayer}</strong>: Azan - ${times.azan}, Iqama - ${times.iqama}`;
            container.appendChild(div);
          }
        });
      })
      .catch(err => {
        console.error("Fetch error:", err);
        document.getElementById("prayer-times").textContent = "Failed to load data.";
      });
 
    // Notifications subscribe button
    function subscribeUser() {
      OneSignal.push(function() {
        OneSignal.showNativePrompt();
      });
    }
  </script>
</body>
</html>
